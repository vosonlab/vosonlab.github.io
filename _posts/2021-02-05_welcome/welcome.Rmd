---
title: "Welcome to the VOSON Lab Code Blog"
description: |
  The code blog is a space to share tools, methods, tips, examples and code. A place to collect data, construct and analyze online networks.
author:
  - name: VOSON Lab 
    url: http://vosonlab.net/
    affiliation: School of Sociology,
    affiliation_url: http://vosonlab.net/
  - name:  
    affiliation: Australian National University
date: February 4, 2021
categories:
  - rstats
  - SNA
  - Computational Social Science
preview: square-cards.png
output:
  distill::distill_article:
    self_contained: false
---

Welcome to the [VOSON Lab](http://vosonlab.net/) Code Blog! We have created this space to share methods, tips, examples and code. It's also a place where we will demonstrate constructing and analyzing networks from various API and other online data sources. 

Most of our posts will cover techniques around the tools we have developed at the Lab: `vosonSML`, `VOSONDash` and `voson.tcn`, which are available on both [CRAN](https://cran.r-project.org/package=vosonSML) and [GitHub](https://github.com/vosonlab). But we also plan to use this space to cover other complementary R packages and open-source software, such as fantastic R packages within the [`tidyverse`](https://www.tidyverse.org/), RStudio's [`shiny`](https://www.rstudio.com/products/shiny/) for web apps, and visualization tools such as [`igraph`](https://igraph.org/r/) and [`Gephi`](https://gephi.org/).

![VOSON Lab R Packages - Hex stickers](VOSON-tools.png)

### VOSON Lab Open Source Tools

`vosonSML` is a R package for social media data collection (currently twitter, youtube, and reddit), hyperlink collection and network generation. `VOSONDash` is a `Shiny` app that integrates tools for visualizing and manipulating network graphs, performing network and text analysis, as well as an interface for collecting data with `vosonSML`.

More information on these packages, their development and code can be found on our [`vosonSML`](https://github.com/vosonlab/vosonSML), [`VOSONDash`](https://github.com/vosonlab/VOSONDash) and [`voson.tcn`](https://github.com/vosonlab/voson.tcn) github pages. 

We also have some other guides for using the packages. Check the [vosonSML Vignette](https://vosonlab.github.io/vosonSML/articles/Intro-to-vosonSML.html) and the [VOSON Dash Userguide](https://vosonlab.github.io/VOSONDashDocs/) for some practical examples and feature reference. 

We hope you find this content useful!

The VOSON Lab team.

*Virtual Observatory for the Study of Online Networks [VOSON Lab](http://vosonlab.net/), School of Sociology, The Australian National University.*

```{r timeline, echo = TRUE, eval = FALSE}
## collect @paygapapp timeline tweets using v1.1 API

library(dplyr); library(lubridate); library(rtweet); library(voson.tcn)

# collect all available timeline tweets for the bot
gpg_bot_tl <-
  rtweet::get_timeline(c("PayGapApp"), n = Inf, retryonratelimit = TRUE)

# filter for the #iwd2022 time period
gpg_bot_tl <- gpg_bot_tl |>
  filter(created_at > ymd_hms("2022-03-03 23:59:59") &
           created_at < ymd_hms("2022-03-13 00:00:00"))
```

```{r, echo = TRUE, eval = FALSE}
## collect tweets using v2 API for metadata

# filter for only timeline tweets that are quote tweets
quote_tweets <- gpg_bot_tl |> filter(is_quote == TRUE)

# get tweet ids of quoted tweets
org_tweet_ids <- quote_tweets |> pull(quoted_status_id) |> unique()

# get tweet ids from the bot timeline
bot_tweet_ids <- quote_tweets |> pull(status_id) |> unique()

# collect tweets using the twitter v2 api
bot_org_tweets <-
  voson.tcn::tcn_tweets(tweet_ids = c(bot_tweet_ids, org_tweet_ids),
                        token = readRDS("~/.v2_api_token"))
```

```{r, echo = TRUE, eval = FALSE}
## collect conversation thread tweets by conversation_id

# get conversation ids from tweets
conv_ids <- bot_org_tweets |>
  pull(conversation_id) |> unique()

# collect conversation thread tweets
conv_threads <-
  voson.tcn::tcn_threads(
    tweet_ids = conv_ids,
    token = readRDS("~/.v2_api_token"),
    endpoint = "all",
    start_time = "2022-03-03T23:59:59Z",
    end_time = "2022-03-13T00:00:00Z"
  )

> nrow(bot_tl_data)
[1] 3250
> table(bot_tl_data$is_quote)
FALSE  TRUE 
 1308  1942 

> nrow(bot_tl_data)
[1] 2001
> table(bot_tl_data$is_quote)
FALSE  TRUE 
  202  1799

> nrow(conv_threads$tweets)
[1] 24130
> nrow(conv_threads$users)
[1] 10042
  
> nrow(conv_threads$tweets)
[1] 24130
> nrow(conv_threads$users)
[1] 10042
> table(conv_threads$errors$type)
https://api.twitter.com/2/problems/not-authorized-for-resource 
                                                           137 
         https://api.twitter.com/2/problems/resource-not-found 
                                                           742
                                                           
####################
                                                           
> nrow(bot_org_tweets$tweets)
[1] 5555
> nrow(bot_org_tweets$users)
[1] 3026
> nrow(bot_org_tweets$errors)
[1] 2
> table(bot_org_tweets$errors$type)
https://api.twitter.com/2/problems/resource-not-found 
                                                    2 
```

```{r, echo = TRUE, eval = FALSE}
## create networks from collected tweet data

# create networks
actor_net <- conv_threads |> voson.tcn::tcn_network(type = "actor")
```

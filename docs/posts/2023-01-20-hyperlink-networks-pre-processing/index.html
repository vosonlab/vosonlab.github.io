<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques</title>

<meta property="description" itemprop="description" content="Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools"/>

<link rel="canonical" href="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"/>
<link rel="license" href="https://creativecommons.org/licenses/by/4.0/"/>
<link rel="icon" type="image/png" href="../../images/favicon.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-02-22"/>
<meta property="article:created" itemprop="dateCreated" content="2023-02-22"/>
<meta name="article:author" content="Robert Ackland"/>
<meta name="article:author" content="Sidiq Madya"/>
<meta name="article:author" content="Francisca Borquez"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools"/>
<meta property="og:url" content="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"/>
<meta property="og:image" content="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/seeds_important2.png"/>
<meta property="og:image:width" content="800"/>
<meta property="og:image:height" content="800"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="VOSON Lab Code Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques"/>
<meta property="twitter:description" content="Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools"/>
<meta property="twitter:url" content="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"/>
<meta property="twitter:image" content="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/seeds_important2.png"/>
<meta property="twitter:image:width" content="800"/>
<meta property="twitter:image:height" content="800"/>
<meta property="twitter:site" content="@vosonlab"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques"/>
<meta name="citation_fulltext_html_url" content="https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/02/22"/>
<meta name="citation_publication_date" content="2023/02/22"/>
<meta name="citation_author" content="Robert Ackland"/>
<meta name="citation_author_institution" content="VOSON Lab, School of Sociology, Australian National University"/>
<meta name="citation_author" content="Sidiq Madya"/>
<meta name="citation_author_institution" content="VOSON Lab, School of Sociology, Australian National University"/>
<meta name="citation_author" content="Francisca Borquez"/>
<meta name="citation_author_institution" content="VOSON Lab, School of Sociology, Australian National University"/>
<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=WWW hyperlink networks;citation_publisher=Morgan-Kaufmann;citation_author=R. Ackland"/>
  <meta name="citation_reference" content="citation_title=Online collective identity: The case of the environmental movement;citation_volume=33;citation_doi=https://doi.org/10.1016/j.socnet.2011.03.001;citation_author=R. Ackland;citation_author=M. Oâ€™Neil"/>
  <meta name="citation_reference" content="citation_title=A relational hyperlink analysis of an online social movement;citation_volume=12;citation_author=D. Lusher;citation_author=R. Ackland"/>
  <meta name="citation_reference" content="citation_title=Web social science: Concepts, data and tools for social scientists in the digital age;citation_publisher=SAGE Publications;citation_author=R. Ackland"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["creative_commons","title","description","author","date","categories","preview","output","draft","bibliography","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["CC BY"]},{"type":"character","attributes":{},"value":["Hyperlink networks: data pre-processing techniques"]},{"type":"character","attributes":{},"value":["Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Robert Ackland"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["https://orcid.org/0000-0002-0008-1766"]}},"value":[{"type":"NULL"}]},{"type":"character","attributes":{},"value":["VOSON Lab, School of Sociology, Australian National University"]},{"type":"character","attributes":{},"value":["http://vosonlab.net/"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation"]}},"value":[{"type":"character","attributes":{},"value":["Sidiq Madya"]},{"type":"character","attributes":{},"value":["VOSON Lab, School of Sociology, Australian National University"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation"]}},"value":[{"type":"character","attributes":{},"value":["Francisca Borquez"]},{"type":"character","attributes":{},"value":["VOSON Lab, School of Sociology, Australian National University"]}]}]},{"type":"character","attributes":{},"value":["2023-02-22"]},{"type":"character","attributes":{},"value":["rstats","hyperlink networks","vosonsml"]},{"type":"character","attributes":{},"value":["seeds_important2.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["refs.bib"]},{"type":"character","attributes":{},"value":["https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"]},{"type":"character","attributes":{},"value":["https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["activity_network.png","actor_network.png","hyperlink-networks-pre-processing_files/anchor-4.2.2/anchor.min.js","hyperlink-networks-pre-processing_files/bowser-1.9.3/bowser.min.js","hyperlink-networks-pre-processing_files/distill-2.2.21/template.v2.js","hyperlink-networks-pre-processing_files/figure-html5/unnamed-chunk-27-1.png","hyperlink-networks-pre-processing_files/figure-html5/unnamed-chunk-27-2.png","hyperlink-networks-pre-processing_files/header-attrs-2.19/header-attrs.js","hyperlink-networks-pre-processing_files/jquery-3.6.0/jquery-3.6.0.js","hyperlink-networks-pre-processing_files/jquery-3.6.0/jquery-3.6.0.min.js","hyperlink-networks-pre-processing_files/jquery-3.6.0/jquery-3.6.0.min.map","hyperlink-networks-pre-processing_files/popper-2.6.0/popper.min.js","hyperlink-networks-pre-processing_files/tippy-6.2.7/tippy-bundle.umd.min.js","hyperlink-networks-pre-processing_files/tippy-6.2.7/tippy-light-border.css","hyperlink-networks-pre-processing_files/tippy-6.2.7/tippy.css","hyperlink-networks-pre-processing_files/tippy-6.2.7/tippy.umd.min.js","hyperlink-networks-pre-processing_files/webcomponents-2.0.0/webcomponents.js","refs.bib","seed_sites_20.csv","seeds_important.png","seeds_important2.png","seeds_plus_important_coded.csv","seeds_plus_important.csv","seeds.png","sites.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.19/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script>
/*
script developed by @MilesMcBainon github
*/
  document.addEventListener("DOMContentLoaded", function () {
    if (!/posts/.test(location.pathname)) {
      return;
    }

    var script = document.createElement("script");
    script.src = "https://utteranc.es/client.js";
    script.setAttribute("repo", "vosonlab/vosonlab.github.io");
    script.setAttribute("issue-term", "og:title");
    script.setAttribute("crossorigin", "anonymous");
    script.setAttribute("label", "comment_thread");

    /* wait for article to load, append script to article element */
    var observer = new MutationObserver(function (mutations, observer) {
      var article = document.querySelector("d-article");
      if (article) {
        observer.disconnect();
        /* HACK: article scroll */
        article.setAttribute("style", "overflow-y: hidden");
        article.appendChild(script);
      }
    });

    observer.observe(document.body, { childList: true });
  });
</script>

<style type="text/css">
.distill-site-header .logo img {
    max-height: 35px;
    margin-bottom: -12px;
    margin-top: 8px;
}

.posts-list-caption {
  margin-top: -35px;
}

d-title {
  padding-bottom: 0 !important;
}

d-byline {
  padding: 0.2rem 0 !important;
}

.posts-list .post-preview .thumbnail {
  /*
  max-width: 400px !important;
  max-height: 300px !important;
  */
  padding-right: 4px;
}

.posts-list .post-preview img {
  /*
  width: 100% !important;
  height: 100% !important;
  */
}

.bs-callout {
  margin: 20px 0;
  padding: 15px 30px 15px 15px;
  border-left: 5px solid #eee;
}

.bs-callout h4 {
  margin-top: 0;
}

.bs-callout p:last-child {
  margin-bottom: 0;
}

.bs-callout code,
.bs-callout .highlight {
  background-color: #fff;
}

.bs-callout-danger {
  background-color: #fcf2f2;
  border-color: #d9534f;
}

.bs-callout-warning {
  background-color: #fefbed;
  border-color: #f0ad4e;
}

.bs-callout-info {
  background-color: #f0f7fd;
  border-color: #5bc0de;
}

</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Hyperlink networks: data pre-processing techniques","description":"Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools","authors":[{"author":"Robert Ackland","authorURL":{"https://orcid.org/0000-0002-0008-1766":{}},"affiliation":"VOSON Lab, School of Sociology, Australian National University","affiliationURL":"http://vosonlab.net/","orcidID":""},{"author":"Sidiq Madya","authorURL":"#","affiliation":"VOSON Lab, School of Sociology, Australian National University","affiliationURL":"#","orcidID":""},{"author":"Francisca Borquez","authorURL":"#","affiliation":"VOSON Lab, School of Sociology, Australian National University","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-02-22T00:00:00.000+11:00","citationText":"Ackland, et al., 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../images/logo.png"/>
</span>
<a href="../../index.html" class="title">VOSON Lab Code Blog</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="http://vosonlab.net/">
<i class="fa fa-flask" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/vosonlab">
<i class="fa fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://github.com/vosonlab">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Hyperlink networks: data pre-processing techniques</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:rstats" class="dt-tag">rstats</a>
  <a href="../../index.html#category:hyperlink_networks" class="dt-tag">hyperlink networks</a>
  <a href="../../index.html#category:vosonsml" class="dt-tag">vosonsml</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Steps for collecting hyperlink networks with vosonSML and processing hyperlink data using R tools</p></p>
</div>

<div class="d-byline">
  Robert Ackland true (VOSON Lab, School of Sociology, Australian National University)<a href="http://vosonlab.net/" class="uri">http://vosonlab.net/</a>
  
,   Sidiq Madya  (VOSON Lab, School of Sociology, Australian National University)
  
,   Francisca Borquez  (VOSON Lab, School of Sociology, Australian National University)
  
<br/>2023-02-22
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">1. Introduction</a></li>
<li><a href="#collecting-hyperlink-data-via-web-crawling" id="toc-collecting-hyperlink-data-via-web-crawling">2. Collecting hyperlink data via web crawling</a></li>
<li><a href="#creating-hyperlink-networks" id="toc-creating-hyperlink-networks">3. Creating hyperlink networks</a></li>
<li><a href="#processing-nodes-in-the-hyperlink-actor-network" id="toc-processing-nodes-in-the-hyperlink-actor-network">4. Processing nodes in the hyperlink actor network</a>
<ul>
<li><a href="#pagegrouping" id="toc-pagegrouping">4.1 Pagegrouping</a></li>
<li><a href="#pruning" id="toc-pruning">4.2 Pruning</a></li>
<li><a href="#preserving" id="toc-preserving">4.3 Preserving</a></li>
</ul></li>
</ul>
</nav>
</div>
<h2 id="introduction">1. Introduction</h2>
<p>The VOSON software web app â€“ first made publicly available in 2006 â€“ was a tool designed to enable researchers to study Web 1.0 websites as online social networks <span class="citation" data-cites="Ackland2010 AcklandONeil2011 Lusher2011 Ackland2013">(<a href="#ref-Ackland2010" role="doc-biblioref">Ackland 2010</a>, <a href="#ref-Ackland2013" role="doc-biblioref">2013</a>; <a href="#ref-AcklandONeil2011" role="doc-biblioref">Ackland and Oâ€™Neil 2011</a>; <a href="#ref-Lusher2011" role="doc-biblioref">Lusher and Ackland 2011</a>)</span>. The canonical VOSON hyperlink collection was <a href="https://vosonlab.github.io/posts/2021-03-15-hyperlink-networks-with-vosonsml/">reintroduced in 2021 in vosonSML)</a> and it was made available in <a href="https://github.com/vosonlab/VOSONDash">VOSONDash version 0.6.1</a> in February 2023. This post provides the methodological steps and code for collecting hyperlink data using <code>vosonSML</code> and pre-processing hyperlink network data via R, including the specific approaches that were previously available via VOSON software web app (pruning, preserving and pagegrouping).</p>
<h2 id="collecting-hyperlink-data-via-web-crawling">2. Collecting hyperlink data via web crawling</h2>
<p>We collected the hyperlink data using <a href="https://github.com/vosonlab/vosonSML">vosonSML</a>.</p>
<p>First load the libraries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>             <span class='co'>#only need to load this if we use %&gt;% as pipe, otherwise can use |&gt;</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/vosonlab/vosonSML'>vosonSML</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://igraph.org'>igraph</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://stringr.tidyverse.org'>stringr</a></span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>We create a dataframe containing the pages to be crawled. We are reading a csv file with pages for 20 organisations. These organisations are a sample of non-state or non-government entities (for-profit and non-for-profit) which actively engage in â€˜data sovereigntyâ€™ debates as part of their concern in contemporary data politics. These organisations include NGO, research think tank, companies, industry associations, and movements or initiatives from communities. These different group of organisations deal with various issues and values when promoting their agenda ranging from security, privacy, innovation, entrepreneurship, to human rights and social justice.</p>
<p>Being involved in the emerging issues of global data politics, these organisations are based or headquartered in different countries across the globe include the US, UK, Canada, Germany, The Netherlands, Belgium, and Denmark which represent the Global North, and South Africa, India and Hong Kong representing the Global South. The websites are being used by these organisations to participate in the emerging debates on data politics. Their participation in the debates are becoming more intense in the midst of the ongoing process of massive â€˜digitisationâ€™ and â€˜dataficationâ€™ in societies. We have chosen 1 or 2 pages from each website and are using these as â€œseed pagesâ€ where the crawler will start: in this way we are directing the crawler to the pages we think will be most â€œproductiveâ€ in terms of containing hyperlinks and text that are of interest to the study.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#For more information on collecting hyperlink networks using vosonSML, see:</span></span>
<span><span class='co'>#https://vosonlab.github.io/posts/2021-03-15-hyperlink-networks-with-vosonsml/</span></span>
<span></span>
<span><span class='co'># The dataframe needs to have the folllowing fields, for hyperlink collection via vosonSML:</span></span>
<span><span class='co'># page: the seed pages</span></span>
<span><span class='co'># type: the type of crawl, with allowed values:</span></span>
<span><span class='co'>#   int: collect all hyperlinks but only follow links that have same domain as seed page (internal)</span></span>
<span><span class='co'>#   ext: collect all hyperlinks but only follow links that have different domain as seed page (external)</span></span>
<span><span class='co'>#   all: collect and follow all hyperlinks</span></span>
<span><span class='co'># max_depth: how many levels of hyperlinks to follow from seed page</span></span>
<span><span class='co'>#For example:</span></span>
<span><span class='co'>#pages &lt;- data.frame(page = c("http://vosonlab.net",</span></span>
<span><span class='co'>#                             "https://rsss.cass.anu.edu.au",</span></span>
<span><span class='co'>#                             "https://www.ansna.org.au"),</span></span>
<span><span class='co'>#                    type = c("int", "ext", "all"),</span></span>
<span><span class='co'>#                    max_depth = c(1, 1, 1))</span></span>
<span></span>
<span><span class='va'>pages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"seed_sites_20.csv"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>pages</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<colgroup>
<col style="width: 71%" />
<col style="width: 3%" />
<col style="width: 6%" />
<col style="width: 14%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">page</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">max_depth</th>
<th style="text-align: left;">domain</th>
<th style="text-align: left;">country</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://womeninlocalization.com/partners/" class="uri">https://womeninlocalization.com/partners/</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">womeninlocalization.com</td>
<td style="text-align: left;">US</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://womeninlocalization.com/data-localization-laws-around-the-world/" class="uri">https://womeninlocalization.com/data-localization-laws-around-the-world/</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">womeninlocalization.com</td>
<td style="text-align: left;">US</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://iwgia.org/en/network.html" class="uri">https://iwgia.org/en/network.html</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">iwgia.org</td>
<td style="text-align: left;">Denmark</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://www.iwgia.org/en/indigenous-data-sovereignty/4699-iw-2022-indigenous-data-sovereignty.html?filter_tag%5B0%5D=37" class="uri">https://www.iwgia.org/en/indigenous-data-sovereignty/4699-iw-2022-indigenous-data-sovereignty.html?filter_tag[0]=37</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">iwgia.org</td>
<td style="text-align: left;">Denmark</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://indigenousdatalab.org/networks/" class="uri">https://indigenousdatalab.org/networks/</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">indigenousdatalab.org</td>
<td style="text-align: left;">US</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://indigenousdatalab.org/projects-working/" class="uri">https://indigenousdatalab.org/projects-working/</a></td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">indigenousdatalab.org</td>
<td style="text-align: left;">US</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#remove pages that caused error with crawler</span></span>
<span><span class='co'>#Rob to check this again..error might no longer be present with new version of vosonSML</span></span>
<span><span class='va'>pages</span> <span class='op'>&lt;-</span> <span class='va'>pages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"ispa.org.za"</span>, <span class='va'>pages</span><span class='op'>$</span><span class='va'>page</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>Note that for the crawler all we need is a dataframe with three columns: page, type, max_depth (see code above for an explantion of these terms and also see the <a href="https://vosonlab.github.io/posts/2021-03-15-hyperlink-networks-with-vosonsml/">VOSON Lab blog post on crawling using vosonSML</a>), but of course it might be useful to include other meta data in this file that is used in analysis later.</p>
<p>Now run the crawl.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#Remember to set `verbose=TRUE` to see the crawler working</span></span>
<span><span class='va'>crawlDF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Authenticate.html'>Authenticate</a></span><span class='op'>(</span><span class='st'>"web"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Collect.html'>Collect</a></span><span class='op'>(</span><span class='va'>pages</span>, verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='co'>#crawlDF</span></span>
<span></span>
<span><span class='co'>#We will save this dataframe, for use later</span></span>
<span><span class='co'>#saveRDS(crawlDF, "crawlDF.rds")</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>saveRDS</a></span><span class='op'>(</span><span class='va'>crawlDF</span>, <span class='st'>"crawlDF_20_sites_depth1.rds"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h2 id="creating-hyperlink-networks">3. Creating hyperlink networks</h2>
<p>Letâ€™s now create networks from the crawl data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>crawlDF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='st'>"crawlDF_20_sites_depth1.rds"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># explore dataframe structure</span></span>
<span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>crawlDF</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 2,826
Columns: 9
$ url       &lt;chr&gt; &quot;http://goap-global.com&quot;, &quot;http://www.reddit.com/sâ€¦
$ n         &lt;int&gt; 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1,â€¦
$ page_err  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NAâ€¦
$ page      &lt;chr&gt; &quot;https://womeninlocalization.com/partners&quot;, &quot;httpsâ€¦
$ depth     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,â€¦
$ max_depth &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,â€¦
$ parse     &lt;df[,6]&gt; &lt;data.frame[23 x 6]&gt;
$ seed      &lt;chr&gt; &quot;https://womeninlocalization.com/partners&quot;, &quot;htâ€¦
$ type      &lt;chr&gt; &quot;int&quot;, &quot;int&quot;, &quot;int&quot;, &quot;int&quot;, &quot;int&quot;, &quot;int&quot;, &quot;int&quot;, &quot;â€¦</code></pre>
</div>
<p>First we create the activity network: with hyperlink activity networks, the nodes are web pages. For the purpose of visualisation we will simplify the network by removing loops.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># create activity network: nodes are pages hyperlinks were collected from</span></span>
<span><span class='va'>net_activity</span> <span class='op'>&lt;-</span> <span class='va'>crawlDF</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Create.html'>Create</a></span><span class='op'>(</span><span class='st'>"activity"</span><span class='op'>)</span></span>
<span><span class='va'>g_activity</span> <span class='op'>&lt;-</span> <span class='va'>net_activity</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Graph.html'>Graph</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='co'>#simplify the network - remove loops and multiple edges</span></span>
<span><span class='va'>g_activity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='va'>g_activity</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span><span class='st'>"activity_network.png"</span>, width<span class='op'>=</span><span class='fl'>800</span>, height<span class='op'>=</span><span class='fl'>800</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g_activity</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/layout_with_fr.html'>layout_with_fr</a></span><span class='op'>(</span><span class='va'>g_activity</span><span class='op'>)</span>, vertex.label<span class='op'>=</span><span class='st'>""</span>, vertex.size<span class='op'>=</span><span class='fl'>3</span>, edge.width<span class='op'>=</span><span class='fl'>1</span>, edge.arrow.size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<figure>
<img src="activity_network.png" alt="Figure 1: Hyperlink activity network - Nodes are web pages." />
<figcaption aria-hidden="true">Figure 1: Hyperlink activity network - Nodes are web pages.</figcaption>
</figure>
<p>We can see from the visualisation that the hyperlink activity network consists of a number of connected components (sets of nodes that are connected either directly or indirectly). We can look further at these clusters or components.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/components.html'>components</a></span><span class='op'>(</span><span class='va'>g_activity</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>List of 3
 $ membership: Named num [1:1736] 1 2 3 4 5 4 3 3 3 3 ...
  ..- attr(*, &quot;names&quot;)= chr [1:1736] &quot;http://1001lakes.com/products&quot; &quot;http://abo-peoples.org&quot; &quot;http://aimitindia.com&quot; &quot;http://artexte.ca/lang/en&quot; ...
 $ csize     : num [1:15] 195 222 77 55 253 191 68 203 103 92 ...
 $ no        : int 15</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>csize</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   25.0    52.5    92.0   115.7   193.0   253.0 </code></pre>
</div>
<p>The above indicates we have 15 weakly-connected components, and these range in size from 25 nodes to 253 nodes. It is not unexpected that the hyperlink activity network is quite disconnected since two seed pages <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> will only be directly connected if they link to each other and they will be indirectly connected if they link to the same third page.</p>
<p>We now create the actor network: with hyperlink actor networks, the nodes in the actor network are web domains (in this document we use â€œsiteâ€ and â€œdomainâ€ interchangeably). For the purpose of visualisation we will simplify the network by removing loops and multiple edges. Multiple edges can arise because multiple pages within a domain can link to the same or multiple pages within another domain. We will also create an edge weight (â€œweightâ€) to store this information on multiple links between domains.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># create actor network: nodes are site domains of pages hyperlinks were collected from</span></span>
<span><span class='va'>net_actor</span> <span class='op'>&lt;-</span> <span class='va'>crawlDF</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Create.html'>Create</a></span><span class='op'>(</span><span class='st'>"actor"</span><span class='op'>)</span></span>
<span><span class='va'>g_actor</span> <span class='op'>&lt;-</span> <span class='va'>net_actor</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/vosonSML/man/Graph.html'>Graph</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 497</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gsize.html'>ecount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 2826</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#simplify the network - remove loops and multiple edges</span></span>
<span><span class='co'>#we will also create an edge attribute "weight"</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>g_actor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gsize.html'>ecount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 559</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span><span class='st'>"actor_network.png"</span>, width<span class='op'>=</span><span class='fl'>800</span>, height<span class='op'>=</span><span class='fl'>800</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g_actor</span>, layout<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/layout_with_fr.html'>layout_with_fr</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span>, vertex.label<span class='op'>=</span><span class='st'>""</span>, vertex.size<span class='op'>=</span><span class='fl'>3</span>, edge.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>, edge.arrow.size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<figure>
<img src="actor_network.png" alt="Figure 2: Hyperlink actor network - Nodes are web domains." />
<figcaption aria-hidden="true">Figure 2: Hyperlink actor network - Nodes are web domains.</figcaption>
</figure>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/components.html'>components</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>List of 3
 $ membership: Named num [1:497] 1 1 1 1 1 1 1 1 1 1 ...
  ..- attr(*, &quot;names&quot;)= chr [1:497] &quot;1001lakes.com&quot; &quot;2022.mydata.org&quot; &quot;abo-peoples.org&quot; &quot;ada-x.org&quot; ...
 $ csize     : num 497
 $ no        : int 1</code></pre>
</div>
<p>The actor network has 497 nodes and 559 edges. The above indicates we have a single (weakly-connected) component: with hyperlink actor networks seeds are more likely to be connected to one another (either directly or indirectly) as they only need to link to a common domain.</p>
<h2 id="processing-nodes-in-the-hyperlink-actor-network">4. Processing nodes in the hyperlink actor network</h2>
<p>For the rest of this exercise we will use the actor network. We will now look at three approaches for processing hyperlink network data: pagegrouping, pruning, and preserving.</p>
<h3 id="pagegrouping">4.1 Pagegrouping</h3>
<p>Pagegrouping refers to merging nodes within a hyperlink network. A common example of a situation where you may want to apply pagegrouping is when you would like to ensure that a subdomain node is not shown separately in the network i.e.Â it is merged with its domain node. For example, we might want to merge <code>www.anu.edu.au</code> with <code>anu.edu.au</code> (or rename <code>www.anu.edu.au</code> to <code>anu.edu.au</code> if the latter does not already exist). It should be noted that whether this pagegrouping is enacted is dependent on the research setting: it might be the case that you want to keep particular subdomains separate to their parent domain. For example we might want <code>rsss.anu.edu.au</code> or <code>cass.anu.edu.au</code> to be separate nodes, and not merged with <code>anu.edu.au</code>.</p>
<p>There are two approaches we can used to undertake pagerouping: (1) operating on the <code>vosonSML</code> network object (that is then used to create the <code>igraph</code> graph object); (2) operating on the <code>igraph</code> graph object. In this document we will demonstrate method (2).</p>
<h4 id="merging-the-www-subdomain-into-a-canonical-domain">4.1.1 Merging the â€œwwwâ€ subdomain into a canonical domain</h4>
<p>First we are going to consolidate nodes into a single canonical domain. This will involve stripping â€œwwwâ€ from www.x.y if only www.x.y exists and if both www.x.y and x.y exist then the former will be merged into the latter. Note that the following code also works if the canonical domain contains three or more parts e.g.Â x.y.z. Also note that the following step will only modify the www subdomain (e.g.Â www.x.y): other subbdomains (e.g.Â othersub.x.y) are handled below.</p>
<p>Letâ€™s focus on an example present in this dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g_actor</span>             <span class='co'>#easier to write code</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"mydata.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;2022.mydata.org&quot;   &quot;mydata.org&quot;        &quot;oldwww.mydata.org&quot;
[4] &quot;www.mydata.org&quot;   </code></pre>
</div>
<p>So this first step will involve merging www.mydata.org into mydata.org.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='va'>g_actor</span>             <span class='co'>#easier to write code</span></span>
<span></span>
<span><span class='co'>#create vector of the sites that start with "www"</span></span>
<span><span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>www_sites</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"^www\\."</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>c</span> <span class='kw'>in</span> <span class='va'>www_sites</span><span class='op'>)</span><span class='op'>{</span></span>
<span></span>
<span>  <span class='co'>#cat("working on:", c, "\n")</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>t2</span><span class='op'><a href='https://rdrr.io/r/base/Arithmetic.html'>%%</a></span><span class='fl'>100</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"Finished working on"</span>, <span class='va'>c</span>, <span class='st'>"("</span>, <span class='va'>t2</span>, <span class='st'>"of"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>www_sites</span><span class='op'>)</span>, <span class='st'>")\n"</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='va'>ind_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"^"</span>,<span class='va'>c</span>,<span class='st'>"$"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span></span>
<span>  <span class='va'>i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>c</span>,<span class='st'>"^www."</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>#if (c=="www.mydata.org")</span></span>
<span>  <span class='co'>#  break</span></span>
<span>  <span class='co'>#next</span></span>
<span>  <span class='co'>#print(i)</span></span>
<span>  <span class='co'>#print(V(g)$name[grep(i, V(g)$name)])</span></span>
<span>  <span class='co'>#num_parts &lt;- str_count(c, "\\.")</span></span>
<span>  <span class='co'>#print(num_parts)</span></span>
<span>  <span class='co'>#ind &lt;- grep(paste0(i,"$"), as.character(V(g)$name))</span></span>
<span>  <span class='co'>#ind &lt;- grep(paste0("\\.",i,"$"), as.character(V(g)$name))</span></span>
<span>  <span class='co'>#this is a hack...want to match on ".abc.com" or "abc.com"</span></span>
<span>  <span class='co'>#ind &lt;- union(grep(paste0("\\.",i,"$"), as.character(V(g)$name)), grep(paste0("^",i,"$"), as.character(V(g)$name)))</span></span>
<span>  </span>
<span>  <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"^"</span>,<span class='va'>i</span>,<span class='st'>"$"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ind</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>     <span class='co'>#there is only the "www" version, just rename node to domain</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind_i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span></span>
<span>    <span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='va'>t2</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span>    <span class='kw'>next</span></span>
<span>  <span class='op'>}</span></span>
<span>    </span>
<span>  <span class='co'>#Otherwise, we have two versions: www.x.y and x.y: merge these</span></span>
<span>  <span class='co'>#Note we will deal with situation where we have e.g. othersubdomain.x.y below</span></span>
<span>  </span>
<span>  <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ind_i</span>, <span class='va'>ind</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'>#ind &lt;- sort(ind)</span></span>
<span>  <span class='co'>#print(ind)</span></span>
<span></span>
<span>  <span class='co'>#if (length(ind)&gt;1)</span></span>
<span>  <span class='co'>#  break</span></span>
<span>    </span>
<span>  <span class='co'>#merging nodes involves creating a map of vertices e.g. if we have 5 vertices </span></span>
<span>  <span class='co'>#and want to merge nodes 1 and 2 and also merge nodes 3 and 4 the map needs to be:</span></span>
<span>  <span class='co'>#1 1 2 2 3</span></span>
<span>  <span class='co'>#i.e. nodes 1 and 2 become node 1, nodes 3 and 4 become node 2, and node 5 becomes node 3</span></span>
<span>  <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'>#print(j)</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>ind</span><span class='op'>)</span><span class='op'>{</span>     <span class='co'>#node to merge </span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span>               <span class='co'>#not node to merge</span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>t</span><span class='op'>)</span></span>
<span>      <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>#need to use vertex.attr.comb="first" or else get weird lists in attribute</span></span>
<span>  <span class='co'>#and it messes things up.  Replaced anyway...</span></span>
<span>  <span class='va'>g</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/contract.html'>contract</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>map_i</span>, vertex.attr.comb<span class='op'>=</span><span class='st'>"first"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span>                <span class='co'>#rename the node to the non-www version</span></span>
<span>  </span>
<span>  <span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='va'>t2</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span>  </span>
<span><span class='op'>}</span></span></code></pre>
</div>
<pre><code>Finished working on www.globalhealthstrategies.com ( 100 of 262 )
Finished working on www.privacyshield.gov ( 200 of 262 )</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#We have reduced the number of nodes from:</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 497</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#to</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 478</code></pre>
</div>
<h4 id="merging-other-subdomains-into-the-canonical-domain">4.1.2 Merging other subdomains into the canonical domain</h4>
<p>Now have only a single canonical version of the mydata.org domain, but there are still two subdomains (other than www).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"mydata.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;2022.mydata.org&quot;   &quot;mydata.org&quot;        &quot;oldwww.mydata.org&quot;</code></pre>
</div>
<p>In this next step we will merge all remaining subdomains into the canonical domain.</p>
<p>However, there might be examples of subdomains that we want â€œpreservedâ€ (not merged into the canonical domain); they should be specified in advance.</p>
<p>A good example is websites created using Wordpress.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"wordpress.com"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;coporwa1en.wordpress.com&quot;              
[2] &quot;datasovereigntynow.files.wordpress.com&quot;
[3] &quot;en.wordpress.com&quot;                      
[4] &quot;indigenousdatalab.wordpress.com&quot;       
[5] &quot;institutdayakologi.wordpress.com&quot;      
[6] &quot;isocbg.wordpress.com&quot;                  
[7] &quot;ourgovdotin.files.wordpress.com&quot;       
[8] &quot;subscribe.wordpress.com&quot;               
[9] &quot;wordpress.com&quot;                         </code></pre>
</div>
<p>If we donâ€™t â€œpreserveâ€ these wordpress websites (which are run by different organisations or groups) then they will all be merged into a single node wordpress.com.</p>
<p>We will implement two types of preserving: (1) preserve specific subdomains, (2) preserve all subdomains via a wildcard match.</p>
<p>In the example below we will preserve specific wordpress subdomains (and the rest will be merged into the canonincal domain wordpress.com) and we will preserve all subdomains for mydata.org.</p>
<p>A final point to note is that the â€œwildcardâ€ approach to preserving subddomains (what we are doing for mydata.org) will only work if mydata.org exists in the network. From the following, we can see that mydata.org exists, but fraunhofer.de does not exist.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"mydata.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;2022.mydata.org&quot;   &quot;mydata.org&quot;        &quot;oldwww.mydata.org&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"fraunhofer.de"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;isst.fraunhofer.de&quot;              
[2] &quot;websites.fraunhofer.de&quot;          
[3] &quot;dataspaces.fraunhofer.de&quot;        
[4] &quot;iee.fraunhofer.de&quot;               
[5] &quot;iml.fraunhofer.de&quot;               
[6] &quot;medical-data-space.fraunhofer.de&quot;</code></pre>
</div>
<p>If the canonical domain doesnâ€™t exist, as in the case of fraunhofer.de, then we need a separate process to undertake pagegrouping. We do this for fraunhofer.de in the section on â€œcustom mergingâ€ below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#vector containing the information for preserving subdomains</span></span>
<span><span class='co'>#we would most likely store this as a csv file with notes on choices made</span></span>
<span><span class='va'>preserve</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"*mydata.org"</span>, <span class='st'>"coporwa1en.wordpress.com"</span>, <span class='st'>"institutdayakologi.wordpress.com"</span>,</span>
<span>              <span class='st'>"indigenousdatalab.wordpress.com"</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>{</span></span>
<span></span>
<span>  <span class='co'>#cat("working on:", i, "\n")</span></span>
<span>  <span class='va'>ind_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>#want to match only on ".x.y" not "x.y"</span></span>
<span>  <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"\\."</span>,<span class='va'>i</span>,<span class='st'>"$"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>#skip any subdomains that are to be preserved</span></span>
<span>  <span class='va'>ind_g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='va'>preserve</span><span class='op'>)</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='va'>ind_g</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"^\\*"</span>,<span class='va'>preserve</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>)</span><span class='op'>{</span>        <span class='co'>#wildcard, skip all subdomains</span></span>
<span>      <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span>      <span class='kw'>break</span></span>
<span>    <span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span></span>
<span>      <span class='va'>ind_rem</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>==</span><span class='va'>preserve</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span></span>
<span>      <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='va'>ind</span><span class='op'>[</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>ind</span><span class='op'>==</span><span class='va'>ind_rem</span><span class='op'>)</span><span class='op'>]</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>      </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ind</span><span class='op'>)</span><span class='op'>)</span>              <span class='co'>#there is no subdomain(s)</span></span>
<span>    <span class='kw'>next</span></span>
<span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"working on:"</span>, <span class='va'>i</span>, <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>#We have one or more subdomains</span></span>
<span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ind_i</span>, <span class='va'>ind</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ind</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'>#print(j)</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>ind</span><span class='op'>)</span><span class='op'>{</span>     <span class='co'>#node to merge</span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span>               <span class='co'>#not node to merge</span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>t</span><span class='op'>)</span></span>
<span>      <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>g</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/contract.html'>contract.vertices</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>map_i</span>, vertex.attr.comb<span class='op'>=</span><span class='st'>"first"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>i</span></span>
<span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
<pre><code>working on: arizona.edu 
[1] &quot;nni.arizona.edu&quot;           &quot;nnigovernance.arizona.edu&quot;
[1]   9 163 164
working on: innovalia.org 
[1] &quot;idsa.innovalia.org&quot;
[1] 118 127
working on: internationaldataspaces.org 
[1] &quot;docs.internationaldataspaces.org&quot;
[1]  66 128
working on: wordpress.com 
[1] &quot;datasovereigntynow.files.wordpress.com&quot;
[2] &quot;en.wordpress.com&quot;                      
[3] &quot;isocbg.wordpress.com&quot;                  
[4] &quot;ourgovdotin.files.wordpress.com&quot;       
[5] &quot;subscribe.wordpress.com&quot;               
[1]  50  79 131 168 200 228
working on: amazon.com 
[1] &quot;aws.amazon.com&quot;
[1]  13 240
working on: google.com 
[1] &quot;docs.google.com&quot;     &quot;maps.google.com&quot;     &quot;podcasts.google.com&quot;
[4] &quot;policies.google.com&quot;
[1]  65 143 172 173 323
working on: linkedin.com 
[1] &quot;de.linkedin.com&quot;
[1]  53 364
working on: microsoft.com 
[1] &quot;azure.microsoft.com&quot;
[1]  14 376
working on: nativeweb.org 
[1] &quot;ayf.nativeweb.org&quot;   &quot;saiic.nativeweb.org&quot;
[1] 248 380 413
working on: wto.org 
[1] &quot;docs.wto.org&quot;
[1]  67 456</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#We have reduced the number of nodes from:</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 497</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#to</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 459</code></pre>
</div>
<p>The following shows that the correct subdomains have been preserved. The two subdomains of mydata.org have been preserved.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"mydata.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;2022.mydata.org&quot;   &quot;mydata.org&quot;        &quot;oldwww.mydata.org&quot;</code></pre>
</div>
<p>We have preserved three subdomains of wordpress.com, and the rest have been merged into the canonical domain.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"wordpress.com"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;coporwa1en.wordpress.com&quot;        
[2] &quot;wordpress.com&quot;                   
[3] &quot;indigenousdatalab.wordpress.com&quot; 
[4] &quot;institutdayakologi.wordpress.com&quot;</code></pre>
</div>
<h4 id="custom-merging-of-domains">4.1.3 Custom merging of domains</h4>
<p>The above code showed how to merge subdomains â€œin bulkâ€, and we also showed how to control this merging by â€œpreservingâ€ subdomains. But we might need to undertake an additional step for merging domains and subdomains. When an organisation uses two or more websites, it might be desirable to merge the relevant domains into a single node in the actor network. The following approach also takes account of the situation we found above for fraunhofer.de: the bulk merging did not work because the canonical domain fraunhofer.de doesnâ€™t yet exist in our hyperlink actor network.</p>
<p>The following code does this with reference to the following examples:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"womeninlocalization"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;womeninlocalization.com&quot; &quot;womeninlocalization.org&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"fraunhofer"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;isst.fraunhofer.de&quot;              
[2] &quot;websites.fraunhofer.de&quot;          
[3] &quot;dataspaces.fraunhofer.de&quot;        
[4] &quot;iee.fraunhofer.de&quot;               
[5] &quot;iml.fraunhofer.de&quot;               
[6] &quot;medical-data-space.fraunhofer.de&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"undocs|undp|uneca|unpo|unhcr|unstats|unwomen|unesco|un\\.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code> [1] &quot;digitallibrary.un.org&quot; &quot;en.unesco.org&quot;        
 [3] &quot;lac.unwomen.org&quot;       &quot;tierracomun.org&quot;      
 [5] &quot;undocs.org&quot;            &quot;unstats.un.org&quot;       
 [7] &quot;undp.org&quot;              &quot;uneca.org&quot;            
 [9] &quot;unhcr.org&quot;             &quot;unpo.org&quot;             </code></pre>
</div>
<p>As with the above, this step involves pre-specification of how the sites are to be merged. We will use a wildcard to merge the two womeninlocalization sites. We will also bulk merge subdomains of fraunhofer.de, preserving two subdomains. Finally, we will merge selected domains from the UN into a canonical domain un.org. Note that in the case of fraunhofer and the UN, the decision of exactly which subdomains and domains to merge is arbitrary: this is just for purposes of showing example code.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#vector containing the information for preserving subdomains</span></span>
<span><span class='co'>#we would most likely store this as a csv file with notes on choices made</span></span>
<span><span class='va'>preserve</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"dataspaces.fraunhofer.de"</span>,<span class='st'>"medical-data-space.fraunhofer.de"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#the above process of merging subdomains will only work if there was www.x.y in the original dataset</span></span>
<span><span class='co'>#if this is not the case, and want to merge subdomains using a wildcard, then specify the canonical domain here</span></span>
<span><span class='co'>#note that here we use a dataframe with the first column being the canonical domain (what other domains/subdomains will be merged into), and subsequent columns are the other domains/subdomains.  If only the first column is specified, then a bulk merge will be undertaken</span></span>
<span><span class='co'>#There are two types of merge below:</span></span>
<span><span class='co'># (1) bulk merge: this is when there is only one column in the data frame, the canonical domain.  This domain needs to be contained in the subdomains that are to be merged</span></span>
<span><span class='co'># (2) bespoke merge: this is when the first column contains the domain which all the other subdomains/domains will be merged into.  Note that this domain does not even need to exist in the hyperlink actor network</span></span>
<span><span class='co'>#the following will only work if the canonical domain is contained in at least one </span></span>
<span><span class='co'>#Note that this would normally be stored in csv file</span></span>
<span><span class='va'>ex1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>V1<span class='op'>=</span><span class='st'>"womeninlocalization.org"</span>, V2<span class='op'>=</span><span class='st'>"womeninlocalization.com"</span><span class='op'>)</span>    <span class='co'>#bespoke merge</span></span>
<span><span class='va'>ex2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>V1<span class='op'>=</span><span class='st'>"fraunhofer.de"</span><span class='op'>)</span>                                            <span class='co'>#bulk merge</span></span>
<span><span class='va'>ex3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>V1<span class='op'>=</span><span class='st'>"un.org"</span>, V2<span class='op'>=</span><span class='st'>"en.unesco.org"</span>, V3<span class='op'>=</span><span class='st'>"lac.unwomen.org"</span>, V4<span class='op'>=</span><span class='st'>"undocs.org"</span>, V5<span class='op'>=</span><span class='st'>"unstats.un.org"</span>, V6<span class='op'>=</span><span class='st'>"undp.org"</span>, V7<span class='op'>=</span><span class='st'>"uneca.org"</span><span class='op'>)</span>         <span class='co'>#bespoke merge</span></span>
<span><span class='va'>mergeDF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>ex1</span>, <span class='va'>ex2</span>, <span class='va'>ex3</span><span class='op'>)</span></span>
<span><span class='co'>#note that we preserve particular subdomains of fraunhofer.de by including in preserve above</span></span>
<span></span>
<span><span class='co'>#seems most efficient to iterate over nodes first, rather than iterating over merges first</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  </span>
<span>  <span class='co'>#cat("working on:", i, "\n")</span></span>
<span>  <span class='va'>ind_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>==</span><span class='va'>i</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>m</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>mergeDF</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>col1</span> <span class='op'>&lt;-</span> <span class='va'>mergeDF</span><span class='op'>[</span><span class='va'>m</span>,<span class='fl'>1</span><span class='op'>]</span></span>
<span>    <span class='va'>othcol</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span>    <span class='kw'>for</span> <span class='op'>(</span><span class='va'>m2</span> <span class='kw'>in</span> <span class='fl'>2</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>mergeDF</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>mergeDF</span><span class='op'>[</span><span class='va'>m</span>,<span class='va'>m2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>)</span></span>
<span>        <span class='va'>othcol</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>othcol</span>, <span class='va'>mergeDF</span><span class='op'>[</span><span class='va'>m</span>,<span class='va'>m2</span><span class='op'>]</span><span class='op'>)</span></span>
<span>      <span class='kw'>else</span></span>
<span>        <span class='kw'>break</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='co'>#print(col1)</span></span>
<span>    <span class='co'>#print(othcol)</span></span>
<span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>othcol</span><span class='op'>)</span><span class='op'>)</span>                 <span class='co'>#bulk match - grep match on first col</span></span>
<span>      <span class='va'>ind_g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='va'>col1</span>,<span class='va'>i</span><span class='op'>)</span>              <span class='co'>#should search on ".[pattern]"</span></span>
<span>    <span class='kw'>else</span></span>
<span>      <span class='va'>ind_g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='va'>othcol</span><span class='op'>)</span>           <span class='co'>#exact match on othcol</span></span>
<span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ind_g</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>ind_g</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span></span>
<span>      </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>ind_g</span><span class='op'>)</span><span class='op'>)</span>                   <span class='co'>#we have a match</span></span>
<span>      <span class='kw'>break</span></span>
<span>  <span class='op'>}</span></span>
<span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>ind_g</span><span class='op'>)</span><span class='op'>)</span>        <span class='co'>#no merging for this node</span></span>
<span>    <span class='kw'>next</span></span>
<span>    </span>
<span>  <span class='co'>#we are going to merge only node i (this is different to the above code)</span></span>
<span>    </span>
<span>  <span class='co'>#break</span></span>
<span>  </span>
<span>  <span class='co'>#but first check that this node is not to be preserved</span></span>
<span>  <span class='co'>#can be exact match for this</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='va'>preserve</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='st'>"is to be preserved\n"</span><span class='op'>)</span></span>
<span>    <span class='kw'>next</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>#Also check that the node we are merging is not the same as the node we are merging to i.e. not merging</span></span>
<span>  <span class='co'>#fraunhofer.de -&gt; fraunhofer.de</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>i</span><span class='op'>==</span><span class='va'>col1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='st'>", trying to merge node with itself...\n"</span><span class='op'>)</span></span>
<span>    <span class='kw'>next</span></span>
<span>  <span class='op'>}</span></span>
<span>    </span>
<span>  <span class='co'>#break</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='va'>i</span>, <span class='st'>"merged to"</span>, <span class='va'>col1</span>, <span class='st'>"\n"</span><span class='op'>)</span> </span>
<span></span>
<span>  <span class='co'>#next we check if the node that i is being merged with even exists</span></span>
<span>  <span class='co'>#if it doesn't then we just rename i, and we are done</span></span>
<span>  <span class='va'>dom_match</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>col1</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>dom_match</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind_i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>col1</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='st'>"renaming"</span>, <span class='va'>i</span>, <span class='st'>"to"</span>, <span class='va'>col1</span>, <span class='st'>"\n"</span><span class='op'>)</span></span>
<span>    <span class='kw'>next</span></span>
<span>  <span class='op'>}</span></span>
<span>   </span>
<span>  <span class='co'>#break</span></span>
<span>  </span>
<span>  <span class='co'>#the following will only have two nodes in it, but use it so can re-use code from above</span></span>
<span>  <span class='va'>ind</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ind_i</span>, <span class='va'>dom_match</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>#break</span></span>
<span>  </span>
<span>  <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span></span>
<span>  <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span></span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='op'>(</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'>#print(j)</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>ind</span><span class='op'>)</span><span class='op'>{</span>     <span class='co'>#node to merge</span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span>               <span class='co'>#not node to merge</span></span>
<span>      <span class='va'>map_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>map_i</span>, <span class='va'>t</span><span class='op'>)</span></span>
<span>      <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='va'>t</span> <span class='op'>+</span> <span class='fl'>1</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>g</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/contract.html'>contract.vertices</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='va'>map_i</span>, vertex.attr.comb<span class='op'>=</span><span class='st'>"first"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='va'>ind</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>col1</span></span>
<span>  </span>
<span><span class='op'>}</span></span></code></pre>
</div>
<pre><code>en.unesco.org merged to un.org 
renaming en.unesco.org to un.org 
isst.fraunhofer.de merged to fraunhofer.de 
renaming isst.fraunhofer.de to fraunhofer.de 
lac.unwomen.org merged to un.org 
undocs.org merged to un.org 
unstats.un.org merged to un.org 
websites.fraunhofer.de merged to fraunhofer.de 
womeninlocalization.com merged to womeninlocalization.org 
dataspaces.fraunhofer.de is to be preserved
iee.fraunhofer.de merged to fraunhofer.de 
iml.fraunhofer.de merged to fraunhofer.de 
medical-data-space.fraunhofer.de is to be preserved
undp.org merged to un.org 
uneca.org merged to un.org </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#We have reduced the number of nodes from:</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g_actor</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 497</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#to</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/gorder.html'>vcount</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 450</code></pre>
</div>
<p>The following confirms that the merges have taken place correctly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"womeninlocalization"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;womeninlocalization.org&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"fraunhofer"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;fraunhofer.de&quot;                   
[2] &quot;dataspaces.fraunhofer.de&quot;        
[3] &quot;medical-data-space.fraunhofer.de&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"undocs|undp|uneca|unpo|unhcr|unstats|unwomen|unesco|un\\.org"</span>, <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>]</span></span></code></pre>
</div>
<pre><code>[1] &quot;digitallibrary.un.org&quot; &quot;un.org&quot;               
[3] &quot;tierracomun.org&quot;       &quot;unhcr.org&quot;            
[5] &quot;unpo.org&quot;             </code></pre>
</div>
<h3 id="pruning">4.2 Pruning</h3>
<p>Pruning refers to removing nodes that are considered not relevant to the analysis. It is highly likely that the web crawler will pick up pages that are not relevant to the study, and so we use pruning to identify and remove these irrelevant pages.</p>
<h4 id="creatng-the-network-containing-just-the-seed-sites">4.2.1 Creatng the network containing just the seed sites</h4>
<p>We will first create an actor network containing just the seed sites: in effect we are â€œpruningâ€ non-seed sites. To start with, we need to identify what are the seed sites: we do this using the <code>pages</code> dataframe we created above for the web crawl. Recall that the <code>pages</code> dataframe contains <em>web pages</em> that we have crawled, but the hyperlink actor network contains <em>websites (or domains)</em>. So we need to process the <code>pages</code> dataframe so as to identify what are the seed sites (not seed pages).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># identify the seed pages and set a node attribute</span></span>
<span><span class='co'># we are also removing http tag and trailing forward slash</span></span>
<span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>pages</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>site <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>page</span>, <span class='st'>"^http[s]?://"</span><span class='op'>)</span>, seed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='co'># also remove trailing "/"</span></span>
<span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>site <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>site</span>, <span class='st'>"/$"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#The following will return just the domain name</span></span>
<span><span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_match.html'>str_match</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span>, <span class='st'>"(.+?)/"</span><span class='op'>)</span></span>
<span><span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"/"</span>, <span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span><span class='op'>)</span>, <span class='va'>a</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span>, <span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#remove redundant column "page" and also user-created column "domain" (to avoid confusion, since not using)</span></span>
<span><span class='co'>#and put "site" colum first</span></span>
<span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>page</span>,<span class='va'>domain</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/relocate.html'>relocate</a></span><span class='op'>(</span><span class='va'>site</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>site</span>, .keep_all<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">site</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">max_depth</th>
<th style="text-align: left;">country</th>
<th style="text-align: left;">seed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">womeninlocalization.com</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">iwgia.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">www.iwgia.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">indigenousdatalab.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">botpopuli.net</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">India</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">cipesa.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">South Africa</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 21</code></pre>
</div>
<p>We have created a dataframe <code>seed_sites</code> which contains the domains extracted from the seed pages used for crawling - this is stored in the column <code>site</code>. We have created a column <code>seed</code> and set this to TRUE (this will be used below when we use this dataframe to identify seed sites in the hyperlink actor network). Note that there was also a column <code>domain</code> but this was manually created at the time the seed pages were identified (in the same way that the column was <code>country</code> was manually created); we do not make use of that column in what follows, and so we removed it from the <code>seed_sites</code> dataframe.</p>
<p>Before proceeding, we need to first make some modifications to the <code>seed_sites</code> dataframe. The pagegrouping step above means that we no longer have the â€œwwwâ€ subdomain present in the hyperlink actor network, and so we need to modify <code>seed_sites</code> by stripping â€œwwwâ€ from the seed sites stored in the column <code>site</code>. Also, the pagegrouping means that we no longer have womeninlocalization.com in the network, so we need to change the seed site to womeninlocalization.org.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>site<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"^www\\."</span>,<span class='st'>""</span>,<span class='va'>site</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span><span class='op'>==</span><span class='st'>"womeninlocalization.com"</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"womeninlocalization.org"</span></span>
<span></span>
<span><span class='va'>seed_sites</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='va'>site</span>, .keep_all<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">site</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">max_depth</th>
<th style="text-align: left;">country</th>
<th style="text-align: left;">seed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">womeninlocalization.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">iwgia.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Denmark</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">indigenousdatalab.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">US</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">botpopuli.net</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">India</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cipesa.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">South Africa</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: left;">mydata.org</td>
<td style="text-align: left;">int</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Finland</td>
<td style="text-align: left;">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>seed_sites</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 20</code></pre>
</div>
<p>So we have 20 seed sites and we are now ready to create the â€œseeds onlyâ€ hyperlink network. To do this, we will create a node attribute â€œseedâ€ which indicates whether a site is a seed or not.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span> <span class='op'>&lt;-</span> <span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, <span class='va'>seed_sites</span><span class='op'>$</span><span class='va'>site</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
TRUE 
  20 </code></pre>
</div>
<p>The above indicates that there are now 20 nodes in the network with the attribute <code>seed</code> equal to 1 (the rest have values of NA), so we have correctly identified our seed sites in the network. We can now visualise the seeds only hyperlink network.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#for the remainder of this exercise we will work with the simiplified network</span></span>
<span><span class='co'>#simplify the network - remove loops and multiple edges</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/simplify.html'>simplify</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>g_seeds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/subgraph.html'>induced.subgraph</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span><span class='st'>"seeds.png"</span>, width<span class='op'>=</span><span class='fl'>800</span>, height<span class='op'>=</span><span class='fl'>800</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g_seeds</span>, vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>, vertex.size<span class='op'>=</span><span class='fl'>3</span>, edge.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g_seeds</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>, edge.arrow.size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<figure>
<img src="seeds.png" alt="Figure 3: Seeds hyperlink network." />
<figcaption aria-hidden="true">Figure 3: Seeds hyperlink network.</figcaption>
</figure>
<p>The above figure shows that the seed sites are very disconnected, with only four pairs of sites connected; this is to be expected given we have only crawled to depth 1 (i.e.Â only the seed page is crawled). If we increased the crawl depth to 2, then it is to be expected that the seeds hyperlink network would become more connected.</p>
<h4 id="creatng-the-network-containing-the-seeds-plus-important-non-seed-sites">4.2.2 Creatng the network containing the seeds plus â€œimportantâ€ non-seed sites</h4>
<p>Next we will create the â€œseeds plus importantâ€ network: this contains the seed sites plus those other sites that are hyperlinked to by two or more seeds.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>g_seedsImp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/subgraph.html'>induced.subgraph</a></span><span class='op'>(</span><span class='va'>g</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>==</span><span class='fl'>1</span> <span class='op'>|</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span><span class='op'>&gt;=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#red nodes are seeds, blue nodes are importnant non-seeds</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>color</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>==</span><span class='fl'>1</span>, <span class='st'>"red"</span>, <span class='st'>"blue"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span><span class='st'>"seeds_important.png"</span>, width<span class='op'>=</span><span class='fl'>800</span>, height<span class='op'>=</span><span class='fl'>800</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span>, vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>, vertex.size<span class='op'>=</span><span class='fl'>3</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span>, mode<span class='op'>=</span><span class='st'>"in"</span><span class='op'>)</span>, edge.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>, edge.arrow.size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><img src="seeds_important.png" alt="Figure 4: Seeds plus important hyperlink network." />
The above visualisation indicates that we now have a much more connected network, indeed it is fully-connected (no isolates) but a casual inspection indicates that many of the so-called â€œimportantâ€ sites are probably not relevant to the analysis. For example, the most central nodes are social media sites (e.g.Â twitter.com, youtube.com). This brings us to the final step in the processing of the hyperlink data: manually pruning irrelevant sites.</p>
<h4 id="manually-pruning-irrelevant-sites">4.2.3 Manually pruning irrelevant sites</h4>
<p>Whether a site is relevant to the research is something only the researcher will know, so this final step is necessarily a manual one. We recommend that the â€œseeds plus importantâ€ network nodes are written to csv file, and then this csv file is manually coded so either the relevant sites are kept or the irrelevant sites are removed. In the example below, we are keeping those sites that are deemed relevant.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#write the sites to csv file, for manual coding</span></span>
<span><span class='co'>#also write seed stauts, since this will be used to determine whether a site is relevant</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>site<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, seed<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>seed</span><span class='op'>)</span>, <span class='st'>"seeds_plus_important.csv"</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p>The sites are manually coded - a new column â€œkeepâ€ is created, with a 1 indicating that the site is either a seed or it is a relevant non-seed site. The coded csv file is then used to create the new sub-network.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>df2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"seeds_plus_important_coded.csv"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>keep</span> <span class='op'>&lt;-</span> <span class='va'>df2</span><span class='op'>$</span><span class='va'>keep</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>name</span>, <span class='va'>df2</span><span class='op'>$</span><span class='va'>site</span><span class='op'>)</span><span class='op'>]</span></span>
<span><span class='va'>g_seedsImp2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/igraph/man/subgraph.html'>induced.subgraph</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span>, <span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/V.html'>V</a></span><span class='op'>(</span><span class='va'>g_seedsImp</span><span class='op'>)</span><span class='op'>$</span><span class='va'>keep</span><span class='op'>==</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/png.html'>png</a></span><span class='op'>(</span><span class='st'>"seeds_important2.png"</span>, width<span class='op'>=</span><span class='fl'>800</span>, height<span class='op'>=</span><span class='fl'>800</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>g_seedsImp2</span>, vertex.label.color<span class='op'>=</span><span class='st'>"black"</span>, vertex.size<span class='op'>=</span><span class='fl'>3</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/degree.html'>degree</a></span><span class='op'>(</span><span class='va'>g_seedsImp2</span>, mode<span class='op'>=</span><span class='st'>"in"</span><span class='op'>)</span>, edge.width<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/igraph/man/E.html'>E</a></span><span class='op'>(</span><span class='va'>g_seedsImp2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>weight</span>, edge.arrow.size<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<p><img src="seeds_important2.png" alt="Figure 5: Seeds plus relevant important hyperlink network." />
The result is a graph presenting a connection or disconnection among organisations discussing â€˜data sovereigntyâ€™ issues on the web. It shows that the debates interestingly place the already powerful institutions such as the UN and the World Bank at the center which makes them appear to be influential actors in the network of data sovereignty debates. Given their prominent positions in the network connecting otherwise separated organisations across countries or regions interested in data politics, it is interesting to gain insight into how organisations such as the UN and the World Bank impose their interest on data sovereignty agenda.</p>
<h3 id="preserving">4.3 Preserving</h3>
<p>We have already mentioned preserving of subdomains above (to prevent all subdomains being merged into a single node when pagregrouping is undertaken). Another example of preserving is when we want to preserve sub-directories. By default, <code>vosonSML</code> does not preserve sub-directories and so <code>www.example.com/subdir1</code> and <code>www.example.com/subdir2</code> would, by default, be merged to the node <code>www.example.com</code>. Preserving these sub-diretories would involve working with the activity network object returned by <code>vosonSML</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>net_activity</span><span class='op'>$</span><span class='va'>edges</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 6 Ã— 2
  from                                     to                         
  &lt;chr&gt;                                    &lt;chr&gt;                      
1 https://womeninlocalization.com/partners http://goap-global.com     
2 https://womeninlocalization.com/partners http://www.reddit.com/submâ€¦
3 https://womeninlocalization.com/partners https://csa-research.com   
4 https://womeninlocalization.com/partners https://euatc.org          
5 https://womeninlocalization.com/partners https://locworld.com       
6 https://womeninlocalization.com/partners https://slator.com         </code></pre>
</div>
<p>It would be necessary to process the URLs in the <code>from</code> and <code>to</code> using similar techniques to those presented above e.g.Â converting URLs to the domain names, but preserving certain sub-directories. Then the <code>vosonSML</code> <code>Create()</code> function can be used to create the igraph graph object. We will not cover this in full here, but leave this for a future blog post.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Ackland2010" class="csl-entry" role="doc-biblioentry">
Ackland, R. 2010. <span>â€œ<span>WWW</span> Hyperlink Networks.â€</span> In <em>Analyzing Social Media Networks with NodeXL: Insights from a Connected World</em>, edited by D. L. Hansen, B. Shneiderman, and M. A. Smith. Burlington, MA: Morgan-Kaufmann.
</div>
<div id="ref-Ackland2013" class="csl-entry" role="doc-biblioentry">
â€”â€”â€”. 2013. <em>Web Social Science: Concepts, Data and Tools for Social Scientists in the Digital Age</em>. London: SAGE Publications.
</div>
<div id="ref-AcklandONeil2011" class="csl-entry" role="doc-biblioentry">
Ackland, R., and M. Oâ€™Neil. 2011. <span>â€œOnline Collective Identity: The Case of the Environmental Movement.â€</span> <em>Social Networks</em> 33: 177â€“90. https://doi.org/<a href="https://doi.org/10.1016/j.socnet.2011.03.001">https://doi.org/10.1016/j.socnet.2011.03.001</a>.
</div>
<div id="ref-Lusher2011" class="csl-entry" role="doc-biblioentry">
Lusher, D., and R. Ackland. 2011. <span>â€œA Relational Hyperlink Analysis of an Online Social Movement.â€</span> <em>Journal of Social Structure</em> 12 (5).
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Hyperlink%20networks%3A%20data%20pre-processing%20techniques&amp;url=https%3A%2F%2Fvosonlab.github.io%2Fposts%2F2023-01-20-hyperlink-networks-pre-processing%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fvosonlab.github.io%2Fposts%2F2023-01-20-hyperlink-networks-pre-processing%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Ackland, et al. (2023, Feb. 22). VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques. Retrieved from https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{ackland2023hyperlink,
  author = {Ackland, Robert and Madya, Sidiq and Borquez, Francisca},
  title = {VOSON Lab Code Blog: Hyperlink networks: data pre-processing techniques},
  url = {https://vosonlab.github.io/posts/2023-01-20-hyperlink-networks-pre-processing/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
